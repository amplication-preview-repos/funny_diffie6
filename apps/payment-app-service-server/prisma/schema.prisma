datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Order {
  bill      Bill?    @relation(name: "BillOnOrders", fields: [billId], references: [id])
  billId    String?
  bills     Bill[]   @relation(name: "BillsOnOrder")
  createdAt DateTime @default(now())
  id        String   @id @default(cuid())
  items     Json?
  prices    Json?
  updatedAt DateTime @updatedAt
}

model PaymentMethod {
  createdAt DateTime                    @default(now())
  details   Json?
  id        String                      @id @default(cuid())
  typeField EnumPaymentMethodTypeField?
  updatedAt DateTime                    @updatedAt
  user      User?                       @relation(fields: [userId], references: [id])
  userId    String?
}

model Tip {
  amount               Float?
  createdAt            DateTime            @default(now())
  id                   String              @id @default(cuid())
  paymentTransaction   PaymentTransaction? @relation(fields: [paymentTransactionId], references: [id])
  paymentTransactionId String?
  updatedAt            DateTime            @updatedAt
}

model Bill {
  createdAt           DateTime             @default(now())
  id                  String               @id @default(cuid())
  order               Order?               @relation(name: "BillsOnOrder", fields: [orderId], references: [id])
  orderId             String?
  orders              Order[]              @relation(name: "BillOnOrders")
  paymentTransactions PaymentTransaction[]
  qrCode              String?
  updatedAt           DateTime             @updatedAt
  user                User?                @relation(fields: [userId], references: [id])
  userId              String?
}

model PaymentTransaction {
  amount    Float?
  bill      Bill?                         @relation(fields: [billId], references: [id])
  billId    String?
  createdAt DateTime                      @default(now())
  id        String                        @id @default(cuid())
  status    EnumPaymentTransactionStatus?
  tips      Tip[]
  updatedAt DateTime                      @updatedAt
}

model User {
  bills          Bill[]
  createdAt      DateTime        @default(now())
  email          String?         @unique
  firstName      String?
  id             String          @id @default(cuid())
  lastName       String?
  name           String?
  password       String
  paymentMethods PaymentMethod[]
  roles          Json
  updatedAt      DateTime        @updatedAt
  username       String          @unique
}

enum EnumPaymentMethodTypeField {
  Option1
}

enum EnumPaymentTransactionStatus {
  Option1
}
